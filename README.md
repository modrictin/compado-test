<svg width="243" height="60" viewBox="0 0 243 60" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M137.07 39.6097L136.07 29.9097L129.52 39.8397L123 29.9997L122.07 39.5997H118.2L120.81 20.2297L129.55 33.8097L138.28 20.2597L140.9 39.5997L137.07 39.6097Z" fill="white"></path><path d="M175.3 39.6103L173.63 36.1003H165L163.33 39.6103H159.33L169.33 20.2703L179.33 39.6103H175.3ZM169.3 27.0303L166.45 33.0903H172.21L169.3 27.0303Z" fill="white"></path><path d="M213.12 20C211.142 20 209.209 20.5865 207.564 21.6853C205.92 22.7841 204.638 24.3459 203.881 26.1732C203.124 28.0004 202.926 30.0111 203.312 31.9509C203.698 33.8907 204.651 35.6725 206.049 37.0711C207.448 38.4696 209.229 39.422 211.169 39.8078C213.109 40.1937 215.12 39.9957 216.947 39.2388C218.774 38.4819 220.336 37.2002 221.435 35.5557C222.534 33.9112 223.12 31.9778 223.12 30C223.12 27.3478 222.067 24.8043 220.191 22.9289C218.316 21.0536 215.772 20 213.12 20ZM213.12 36.17C211.897 36.17 210.702 35.8073 209.686 35.1278C208.669 34.4483 207.877 33.4825 207.41 32.3527C206.942 31.2228 206.82 29.9797 207.06 28.7807C207.299 27.5816 207.888 26.4804 208.754 25.6165C209.619 24.7527 210.721 24.1649 211.921 23.9275C213.12 23.6902 214.363 23.814 215.492 24.2833C216.621 24.7526 217.586 25.5462 218.263 26.5639C218.941 27.5815 219.302 28.7773 219.3 30C219.297 31.6373 218.645 33.2066 217.487 34.3635C216.328 35.5203 214.757 36.17 213.12 36.17Z" fill="white"></path><path d="M104.82 20C102.843 20 100.909 20.5865 99.2646 21.6853C97.6201 22.7841 96.3384 24.3459 95.5815 26.1732C94.8246 28.0004 94.6266 30.0111 95.0125 31.9509C95.3983 33.8907 96.3507 35.6725 97.7492 37.0711C99.1478 38.4696 100.93 39.422 102.869 39.8078C104.809 40.1937 106.82 39.9957 108.647 39.2388C110.474 38.4819 112.036 37.2002 113.135 35.5557C114.234 33.9112 114.82 31.9778 114.82 30C114.82 27.3478 113.767 24.8043 111.891 22.9289C110.016 21.0536 107.472 20 104.82 20ZM104.82 36.17C103.598 36.17 102.402 35.8073 101.386 35.1278C100.369 34.4483 99.5772 33.4825 99.1098 32.3527C98.6423 31.2228 98.5205 29.9797 98.7598 28.7807C98.9991 27.5816 99.5887 26.4804 100.454 25.6165C101.319 24.7527 102.421 24.1649 103.621 23.9275C104.82 23.6902 106.063 23.814 107.192 24.2833C108.321 24.7526 109.286 25.5462 109.964 26.5639C110.642 27.5815 111.002 28.7773 111 30C110.998 31.6373 110.345 33.2066 109.187 34.3635C108.028 35.5203 106.458 36.17 104.82 36.17Z" fill="white"></path><path d="M87.9998 34.3501C87.1371 35.2186 86.0361 35.8114 84.8361 36.0533C83.6362 36.2951 82.3914 36.1752 81.2597 35.7087C80.128 35.2422 79.1603 34.4501 78.4794 33.4329C77.7985 32.4157 77.435 31.2192 77.435 29.9951C77.435 28.771 77.7985 27.5745 78.4794 26.5573C79.1603 25.5401 80.128 24.748 81.2597 24.2815C82.3914 23.815 83.6362 23.6951 84.8361 23.937C86.0361 24.1788 87.1371 24.7716 87.9998 25.6401L90.9297 23.1801C89.5612 21.7105 87.7819 20.687 85.8235 20.2428C83.8651 19.7986 81.8184 19.9544 79.9497 20.6897C78.0811 21.425 76.4771 22.706 75.3466 24.3657C74.2162 26.0254 73.6116 27.987 73.6116 29.9951C73.6116 32.0033 74.2162 33.9649 75.3466 35.6246C76.4771 37.2843 78.0811 38.5652 79.9497 39.3005C81.8184 40.0359 83.8651 40.1916 85.8235 39.7474C87.7819 39.3032 89.5612 38.2797 90.9297 36.8101L87.9998 34.3501Z" fill="white"></path><path d="M188.71 20.5H182.71V39.5H188.71C194.91 39.5 198.89 35.25 198.89 30.01C198.89 24.77 195.55 20.5 188.71 20.5ZM189.18 35.69H186.57V24.3H189.2C192.34 24.3 195.1 26.02 195.1 29.99C195.1 33.96 192.33 35.69 189.18 35.69Z" fill="white"></path><path d="M152.83 20.5H146.12V39.5H149.94V33.09H152.83C154.456 33.0252 155.994 32.3336 157.122 31.1601C158.249 29.9867 158.879 28.4224 158.879 26.795C158.879 25.1676 158.249 23.6033 157.122 22.4299C155.994 21.2564 154.456 20.5648 152.83 20.5ZM152.36 29.69H149.94V23.9H152.36C152.754 23.847 153.155 23.8848 153.533 24.0106C153.91 24.1363 154.254 24.3466 154.537 24.6254C154.821 24.9043 155.037 25.2442 155.169 25.6194C155.302 25.9945 155.346 26.3949 155.3 26.79C155.335 27.183 155.282 27.5786 155.146 27.9489C155.009 28.3191 154.793 28.6546 154.512 28.9316C154.232 29.2086 153.893 29.4202 153.521 29.5513C153.149 29.6824 152.753 29.7298 152.36 29.69Z" fill="white"></path><path d="M70.3701 20H19.8901V22.5H68.8101C69.2563 21.6228 69.7783 20.7863 70.3701 20Z" fill="white"></path><path d="M67.5401 25.8301H19.8901V28.3301H67.1001C67.1793 27.4863 67.3264 26.6502 67.5401 25.8301Z" fill="white"></path><path d="M67.0901 31.6602H19.8901V34.1502H67.5401C67.3287 33.3324 67.1783 32.5001 67.0901 31.6602Z" fill="white"></path><path d="M68.7901 37.49H19.8901V40H70.3501C69.7574 39.2108 69.2354 38.3709 68.7901 37.49Z" fill="white"></path></svg>

# Compado PHP test case (Ebay API)

Example call can look something like this:
http://yourservice.com/search.php?keywords=mac&price_min=100&price_max=1000&sorting=default
The following product attributes should be in the result (if available):
- public $provider; //(=â€œebayâ€œ)
- public $item_id;
- public $click_out_link;
- public $main_photo_url;
- public $price;
- public $price_currency;
- public $shipping_price;
- public $title;
- public $description;
- public $valid_until;
- public $brand;
  ### Bonus questions:
1) sometimes requesting data for the keyword takes a long time (> 5 seconds), what can be done to
   make it faster? What are downsides of your solution?
2) weâ€™d like to add as many product feeds as possible, how would you structure a service with this
   requirement?
   Please make suggestions.

# The solution
    -Tin ModriÄ‡

## Approach
The solution was designed following the test requirements and bonus questions. 
Since the APP KEY was late, the solution was upgraded with the design pattern required to make a support for 
**multiple API providers**. After reading the Ebay API thoroughly the EbayApi class was made containing the function for 
getting the API Data.

## Class diagram

![alt text](https://blue-spark.agency/wp-content/uploads/2022/01/Snimka-zaslona-2022-01-27-000903.png)

## Designing the multiple API Provider support
    weâ€™d like to add as many products feed as possible, how would you structure a service with this
    requirement?

The solution to this problem was using a combination of two design patterns. Interface and Factory design pattern. 
Since we have two API Providers, Ebay and fake Amazon one, we had to transform the data for our end user.
This was achieved by the Adapter pattern.

### Adapter pattern
An interface was created to define a function to get the data from the API, so that function could be easily called 
from the adapter created by the factory. The adapter stored an instance of the API provider which provided the data,
and adapter transformed it for the end user.

### Factory pattern
Since we have adapters for multiple API providers that transform the data, we don't want to write the code for
controlling which adapter to get by providing the parameter. So the factory is created to do just that.
The factory is bound to the application service container and exists there.
The factory has constants defining the API Providers, and once created, the factory stores the adapter to **$existing**
array and if we want to get the same adapter again, it will simply return the existing adapter and save us some 
computing power.


## Bonus question 1
    sometimes requesting data for the keyword takes a long time (> 5 seconds), what can be done to
    make it faster? What are downsides of your solution?
    
Since I got the API key, I did not implement this in to the app to save on time. I had a busy week and I wanted to 
send this by the three-business-day deadline.

### Answer
To make any api request faster, we can cache the data received by the first request. 
The cached data would have its desired expiration time.
Of course, the downside is having to serve the "Old" data to the end user and that the first user that makes a request
will have to wait for the full API time.

This is solvable if we have a search history data, and I believe that Compado company has it.
Having the search history we can take the frequency of the searched let's say Keyword and call an API request
every day or more often if needed to cache the data in advance and speed up every API request (and the first one ).

Also, there are some more downsides if the users are not searching that often. It's difficult to 
cache the API requests including filters, because it is not frequent that the users are using the same let's say price filters
to get the data for some keyword. To solve this, if we are storing the data in the cache, we can store more data and
filter/order/transform it on our end. This will cost us some storage and computing power, but our requests
will be quicker and users happier :)
<hr>

# Test Comments

## Document
APPID was incorrect

The line "_You can find our current web app here: https://www.compado.de._" leads only to the website, not the web app.

There is a typo in sortin g:

- "?keywords=mac&price_min=100&price_max=1000&sortin g=default"

Sorting order (by_price_asc) could be more precise since eBay API doesn't support that type of filter.
The closest type is:
- PricePlusShippingLowest: Sorts items by the combined cost of the item price plus the shipping cost, with the lowest combined price items listed first. Items are returned in the following groupings: lowest total-cost items (for items where shipping was properly specified) appear first, followed by freight- shipping items, and then items for which no shipping was specified. Each group is sorted by price.

## eBay API

The ebay API documentation is really good, but I can't say that for their sandbox enviroment.
The sandbox env serves only the Auction items (no BuyItNow items) without Images, so it's impossible to test that.
I have made a logic to include the highest resolution image blindly.

hen implementing the sort by price ascending function, we get a lot more of results.
Maybe I skipped something in the documentation ðŸ˜†, I had a busy week ðŸ˜«



<hr>

### My comments were here just to improve the test, not criticize it in any way :)!

### Thank you for this experience!
If you have any questions or comments, please let me know.
